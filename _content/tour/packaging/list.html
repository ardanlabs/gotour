<ul>
<li><p><strong>vendor/</strong><br>Good documentation for the <code>vendor/</code> folder can be found in this Gopher Academy <a href="https://blog.gopheracademy.com/advent-2015/vendor-folder">post</a> by Daniel Theophanes. For the purpose of this post, all the source code for 3rd party packages need to be vendored (or copied) into the <code>vendor/</code> folder. This includes packages that will be used from the company <code>Kit</code> project. Consider packages from the <code>Kit</code> project as 3rd party packages.</p>
</li>
<li><p><strong>cmd/</strong><br>All the programs this project owns belongs inside the <code>cmd/</code> folder. The folders under <code>cmd/</code> are always named for each program that will be built. Use the letter <code>d</code> at the end of a program folder to denote it as a daemon. Each folder has a matching source code file that contains the <code>main</code> package.</p>
</li>
<li><p><strong>internal/</strong><br>Packages that need to be imported by multiple programs within the project belong inside the <code>internal/</code> folder. One benefit of using the name <code>internal/</code> is that the project gets an extra level of protection from the compiler. No package outside of this project can import packages from inside of <code>internal/</code>. These packages are therefore internal to this project only.</p>
</li>
<li><p><strong>internal/platform/</strong><br>Packages that are foundational but specific to the project belong in the <code>internal/platform/</code> folder. These would be packages that provide support for things like databases, authentication or even marshaling.</p>
</li>
</ul>
<h2 id="validation">Validation</h2>
<p><u><strong>Validate the location of a package.</strong></u></p>
<ul>
<li><code>Kit</code><ul>
<li>Packages that provide foundational support for the different <code>Application</code> projects that exist.</li>
<li>logging, configuration or web functionality.</li>
</ul>
</li>
<li><code>cmd/</code><ul>
<li>Packages that provide support for a specific program that is being built.</li>
<li>startup, shutdown and configuration.</li>
</ul>
</li>
<li><code>internal/</code><ul>
<li>Packages that provide support for the different programs the project owns.</li>
<li>CRUD, services or business logic.</li>
</ul>
</li>
<li><code>internal/platform/</code><ul>
<li>Packages that provide internal foundational support for the project..</li>
<li>database, authentication or marshaling.</li>
</ul>
</li>
</ul>
<p><u><strong>Validate the dependency choices.</strong></u></p>
<ul>
<li><code>All</code><ul>
<li>Validate the cost/benefit of each dependency.</li>
<li>Question imports for the sake of sharing existing types.</li>
<li>Question imports to others packages at the same level.</li>
<li>If a package wants to import another package at the same level:<ul>
<li>Question the current design choices of these packages.</li>
<li>If reasonable, move the package inside the source tree for the package that wants to import it.</li>
<li>Use the source tree to show the dependency relationships.</li>
</ul>
</li>
</ul>
</li>
<li><code>internal/</code><ul>
<li>Packages from these locations CAN’T be imported:<ul>
<li><code>cmd/</code></li>
</ul>
</li>
</ul>
</li>
<li><code>internal/platform/</code><ul>
<li>Packages from these locations CAN’T be imported:<ul>
<li><code>cmd/</code></li>
<li><code>internal/</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><u><strong>Validate the policies being imposed.</strong></u></p>
<ul>
<li><code>Kit</code>, <code>internal/platform/</code><ul>
<li>NOT allowed to set policy about any application concerns.</li>
<li>NOT allowed to log, but access to trace information must be decoupled.</li>
<li>Configuration and runtime changes must be decoupled.</li>
<li>Retrieving metric and telemetry values must be decoupled.</li>
</ul>
</li>
<li><code>cmd/</code>, <code>internal/</code><ul>
<li>Allowed to set policy about any application concerns.</li>
<li>Allowed to log and handle configuration natively.</li>
</ul>
</li>
</ul>
<p><u><strong>Validate how data is accepted/returned.</strong></u></p>
<ul>
<li><code>All</code><ul>
<li>Validate the consistent use of value/pointer semantics for a given type.</li>
<li>When using an interface type to accept a value, the focus must be on the behavior that is required and not the value itself.</li>
<li>If behavior is not required, use a concrete type.</li>
<li>When reasonable, use an existing type before declaring a new one.</li>
<li>Question types from dependencies that leak into the exported API.<ul>
<li>An existing type may no longer be reasonable to use.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><u><strong>Validate how errors are handled.</strong></u></p>
<ul>
<li><code>All</code><ul>
<li>Handling an error means:<ul>
<li>The error has been logged.</li>
<li>The application is back to 100% integrity.</li>
<li>The current error is not reported any longer.</li>
</ul>
</li>
</ul>
</li>
<li><code>Kit</code><ul>
<li>NOT allowed to panic an application.</li>
<li>NOT allowed to wrap errors.</li>
<li>Return only root cause error values.</li>
</ul>
</li>
<li><code>cmd/</code><ul>
<li>Allowed to panic an application.</li>
<li>Wrap errors with context if not being handled.</li>
<li>Majority of handling errors happen here.</li>
</ul>
</li>
<li><code>internal/</code><ul>
<li>NOT allowed to panic an application.</li>
<li>Wrap errors with context if not being handled.</li>
<li>Minority of handling errors happen here.</li>
</ul>
</li>
<li><code>internal/platform/</code><ul>
<li>NOT allowed to panic an application.</li>
<li>NOT allowed to wrap errors.</li>
<li>Return only root cause error values.</li>
</ul>
</li>
</ul>
<p><u><strong>Validate testing.</strong></u></p>
<ul>
<li><code>cmd/</code><ul>
<li>Allowed to use 3rd party testing packages.</li>
<li>Can have a <code>test</code> folder for tests.</li>
<li>Focus more on integration than unit testing.</li>
</ul>
</li>
<li><code>kit/</code>, <code>internal/</code>, <code>internal/platform/</code><ul>
<li>Stick to the testing package in go.</li>
<li>Test files belong inside the package.</li>
<li>Focus more on unit than integration testing.</li>
</ul>
</li>
</ul>
<p><u><strong>Validate recovering panics.</strong></u></p>
<ul>
<li><code>cmd/</code><ul>
<li>Can recover any panic.</li>
<li>Only if system can be returned to 100% integrity.</li>
</ul>
</li>
<li><code>kit/</code>, <code>internal/</code>, <code>internal/platform/</code><ul>
<li>Can not recover from panics unless:<ul>
<li>Goroutine is owned by the package.</li>
<li>Can provide an event to the app about the panic.</li>
</ul>
</li>
</ul>
</li>
</ul>
